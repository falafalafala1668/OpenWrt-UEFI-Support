--- package/boot/grub2/Makefile	2020-03-21 19:24:36.633527836 +0800
+++ OpenWrt-UEFI-Support/src/package/boot/grub2/Makefile	2020-03-22 20:41:45.000000000 +0800
@@ -8,26 +8,30 @@
 include $(TOPDIR)/rules.mk
 include $(INCLUDE_DIR)/kernel.mk
 
-PKG_NAME:=grub
+# PKG_NAME:=grub
 PKG_CPE_ID:=cpe:/a:gnu:grub2
 PKG_VERSION:=2.04
 PKG_RELEASE:=1
 
-PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.xz
+PKG_SOURCE:=grub-$(PKG_VERSION).tar.xz
 PKG_SOURCE_URL:=@GNU/grub
 PKG_HASH:=e5292496995ad42dabe843a0192cf2a2c502e7ffcc7479398232b10a472df77d
 
+#PKG_FIXUP:=autoreconf
 HOST_BUILD_PARALLEL:=1
-PKG_BUILD_DEPENDS:=grub2/host
 
 PKG_SSP:=0
 
 PKG_FLAGS:=nonshared
 
+PATCH_DIR := ../patches
+HOST_PATCH_DIR := ../patches
+HOST_BUILD_DIR := $(BUILD_DIR_HOST)/$(PKG_NAME)-$(PKG_VERSION)
+
 include $(INCLUDE_DIR)/host-build.mk
 include $(INCLUDE_DIR)/package.mk
 
-define Package/grub2
+define Package/grub2/Default
   CATEGORY:=Boot Loaders
   SECTION:=boot
   TITLE:=GRand Unified Bootloader
@@ -35,19 +39,6 @@
   DEPENDS:=@TARGET_x86
 endef
 
-define Package/grub2-editenv
-  CATEGORY:=Utilities
-  SECTION:=utils
-  SUBMENU:=Boot Loaders
-  TITLE:=Grub2 Environment editor
-  URL:=http://www.gnu.org/software/grub/
-  DEPENDS:=@TARGET_x86
-endef
-
-define Package/grub2-editenv/description
-	Edit grub2 environment files.
-endef
-
 HOST_BUILD_PREFIX := $(STAGING_DIR_HOST)
 
 CONFIGURE_VARS += \
@@ -81,48 +72,3 @@
 	$(SED) 's,(RANLIB),(TARGET_RANLIB),' $(HOST_BUILD_DIR)/grub-core/Makefile.in
 	$(Host/Configure/Default)
 endef
-
-define Host/Install
-	$(call Host/Install/Default)
-
-	$(INSTALL_DIR) $(STAGING_DIR_HOST)/lib/grub/grub2-generic
-	$(STAGING_DIR_HOST)/bin/grub-mkimage \
-		-d $(STAGING_DIR_HOST)/lib/grub/i386-pc \
-		-p /boot/grub \
-		-O i386-pc \
-		-c ./files/grub-early.cfg \
-		-o $(STAGING_DIR_HOST)/lib/grub/grub2-generic/core.img \
-		at_keyboard biosdisk boot chain configfile ext2 linux ls part_msdos reboot serial vga
-
-	$(INSTALL_DIR) $(STAGING_DIR_HOST)/lib/grub/grub2-iso
-	$(STAGING_DIR_HOST)/bin/grub-mkimage \
-		-d $(STAGING_DIR_HOST)/lib/grub/i386-pc \
-		-p /boot/grub \
-		-O i386-pc \
-		-c ./files/grub-early.cfg \
-		-o $(STAGING_DIR_HOST)/lib/grub/grub2-iso/eltorito.img \
-		at_keyboard biosdisk boot chain configfile iso9660 linux ls part_msdos reboot serial vga
-
-	$(INSTALL_DIR) $(STAGING_DIR_HOST)/lib/grub/grub2-legacy
-	$(STAGING_DIR_HOST)/bin/grub-mkimage \
-		-d $(STAGING_DIR_HOST)/lib/grub/i386-pc \
-		-p /boot/grub \
-		-O i386-pc \
-		-c ./files/grub-early.cfg \
-		-o $(STAGING_DIR_HOST)/lib/grub/grub2-legacy/core.img \
-		biosdisk boot chain configfile ext2 linux ls part_msdos reboot serial vga
-endef
-
-define Package/grub2/install
-	$(INSTALL_DIR) $(1)/usr/sbin
-	$(INSTALL_BIN) $(PKG_BUILD_DIR)/grub-bios-setup $(1)/usr/sbin/
-endef
-
-define Package/grub2-editenv/install
-	$(INSTALL_DIR) $(1)/usr/sbin
-	$(INSTALL_BIN) $(PKG_BUILD_DIR)/grub-editenv $(1)/usr/sbin/
-endef
-
-$(eval $(call HostBuild))
-$(eval $(call BuildPackage,grub2))
-$(eval $(call BuildPackage,grub2-editenv))
